function a=polimar(m,tt,ar)%	Ajusta un polinomio sinusoidal a un conjunto de datos (de nivel del%	mar) por el metodo de minimos cuadrados%	using of least squeare method %%	a= polimar(m,tt,ar)%%  m  = matriz de 2 vectores columnas. El primer vector es el indice temporal%       asociado a cada dato, los cuales pueden no ser x-espaciados. El segundo%       vector contiene los datos de nivel del mar%  tt = vector con indices temporales en donde sera evaluado el polinomio. %  ar = vector con los periodos de los armonicos a emplear en el ajuste.%%  a  = retorna la serie de valores predichos para los tiempos dados en tt.%						10/05/93 (c) ORPA%					       Lab. Oce. Fisica UCV.	if min(size(m)) ~= 2, disp('Error, "m" debe tener dos columnas')			pause			returnendar=ar(:);ar=2*pi*(ar.^(-1));nm=m(:,2);t =m(:,1);% calcula promedio y lo sustrae de la serie de nmq=max(size(nm));nmedio=(nm(1)+nm(q))/2;nmedio=( nmedio+sum(nm(2:q-1)) )/(q-1);nm=nm-nmedio;% nar=length(ar);a=zeros(2*nar);b=zeros(2*nar,1);for j=1:nar	for i=1:nar 		a(j,i)         = sum(sin(ar(j).*t).*sin(ar(i).*t));		a(j+nar,i)     = sum(cos(ar(j).*t).*sin(ar(i).*t));		a(j,i+nar)     = sum(sin(ar(j).*t).*cos(ar(i).*t));		a(j+nar,i+nar) = sum(cos(ar(j).*t).*cos(ar(i).*t));    end	b(j)    = sum(nm.*sin(ar(j).*t));	b(j+nar)= sum(nm.*cos(ar(j).*t));end%  pone en X la soluci¢n del sistema  aX = bX=a\b, pause,% ******************************************%	despliega la amplitud y fase de cada armonico ajustado% i=sqrt(-1);%amplitud=abs(X(1:nar)+i*X(nar+1:2*nar));%fase=angle(X(1:nar)+i*X(nar+1:2*nar));%disp('Period')%(ar/(2*pi)).^(-1)%pause%disp('Amplitud')%amplitud %pause%disp('Phase')%fase*180/pi% ***************************************nr=zeros(q,1);for i=1:length(tt)     nr(i) = sum( X(1:nar).*sin(ar.*tt(i)) + X(nar+1:2*nar).*cos(ar.*tt(i)) ); enda=nr+nmedio;return