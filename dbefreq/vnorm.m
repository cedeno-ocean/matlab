 function [uu,vv,ss] = vnorm(u,v)%Function [UU,VV,SS] = vnorm(U,V) -- Vector normalization%  Normalizes a vector series Wj = [Uj,Vj] through a vectorial%  procedure, WWj = [UUj,VVj] = Inv(Sj)*Wj', where S is the square root%  of the variance matrix, Sj = sqrt(Cov(U+i*V)) and j refers to a single%  column of the multiple series matrices [U,V]. An optional output is %  SS, containing the four elements of Sj in the j-th column, such that %  Sj = DEWRAP(SS(:,j),2). The reverse transformation Wj = Sj*WWj' %  denormalizes the series. %%  Ref: Ooyama,K., 1987. Scale-controlled objective analysis, %          Mon.Wea.Rev., 115, 2496-2498, eqn. [9.6] - [9.8]% Initializations[nr,nc] = size(u);w = u + i*v;ss=ones(1,nc);% Compute the SQRT of the vector variancesfor k=1:nc     	ss(k) = sqrt(cov(w(:,k)));end% Conversionssinv = ones(nr,1)*(1./ss);ww = sinv.*w;uu = real(ww);vv = imag(ww);