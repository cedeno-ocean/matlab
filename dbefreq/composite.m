function compyonx = composite(x,y,pos,frac)%Function compYonX = composite(x,y,pos,frac) - Composite <Y> w/r to index <X>%  <X> is a column-vector index and <Y> is a matrix of time series of %  length N at P stations or grid points, where [N,P] = size(Y) and%  N = length(X). FRAC = [Low,High] are the fractional low and high per-%  centiles to composite on. If Low=0 or High=1, the composite is based only %  on the upper or lower percentile, respectively. Values of the composite%  are returned as <compYonX>. Plots a PCOLOR map of compYonX. %%  POS = [Lon,Lat] is a 2-column matix of P locations for plotting.%  If the position vector POS is not input, no plot is produced. %%  Example: FRAC = [1/3,2/3] will compute a Y composite based on on  %           the highest tercile of X minus the lowest tercile of X. %%  Calls: XYZ2MAT, DATAMAP, MEANMISS[nr,nc] = size(y);if nr ~= length(x); disp('Improper dimensions'); return; endif nargin == 3; frac = pos; endcmplo = zeros(nc,1);cmphi = zeros(nc,1);[xs,is] = sort(x);if frac(1) > 0; idxlo = is(1:frac(1)*nr);  cmplo = meanmiss(y(idxlo,:))'; endif frac(2) < 1; idxhi = is(frac(2)*nr:nr); cmphi = meanmiss(y(idxhi,:))'; endcompyonx = cmphi - cmplo;clf; landscapeif nargin == 3; return; end[c,v,x,y] = xyz2mat([pos,compyonx],2,2);datamap(c,v,x,y,1)%datamap(c,[290,350,-30,30],x,y,1)