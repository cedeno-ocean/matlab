function vectmap(x,y,dx,dy,domain,fac)%Function VECTMAP (Lon,Lat,U,V,Domain,Fac)%   Plot a single vector field over a DOMAIN of the tropical Pacific.%%   Domain = [MinLon, MaxLon, MinLat, MaxLat]; %            Default: [120,300,-30,30]%            Longitudes are in degrees east of Greenwich%%   U, V are normalized by STD(ABS(U + i*V)) for viewability.%%   Specify FAC for further scaling; default: FAC = 1.0.%   Calls TROPMAP2, QUIVER% David B. Enfield (NOAA/AOML, Miami, FL/enfield@aoml.erl.gov)% PARSE THE INPUT ARGUMENTSif nargin == 4;fac=1;domain=[120,300,-30,30];endif nargin == 5	if length(domain) == 1;		fac = domain; domain = [120,300,-30,30]; 	else		fac = 1;	endend	% NORMALIZE DATA AND PLOT THE BASE MAPclf; figure(1)denom = std(abs(dx + i*dy));dx = dx/denom; dy = dy/denom;tropmap2(domain);hold on% CALCULATE THE RANGE TO BE USED FOR THE AXES mx = min(min(x)); Mx = max(max(x)); Dx = (Mx-mx)/10;mx = mx-Dx;  Mx = Mx+Dx;my = min(min(y)); My = max(max(y)); Dy = (My-my)/10;my = my-Dy;  My = My+Dy;% AUGMENT VECTORS, IF NECESSARY, TO BE OF EVEN LENGTHn = length(x);if rem(n,2) == 1   x = [ x(:); mx ];  y = [ y(:); my ];   dx = [ dx(:); 0 ]; dy = [ dy(:); 0 ];end% Dx & Dy CONTROL THE DEFAULT LENGTH OF ARROWn = length(x); Dx = (Mx-mx)/10;Dy = (My-my)/10;% TURN VECTORS INTO A 2-COLUMN MATRIX, SO WE CAN USE  quiverx = [ mx mx+Dx; mx+Dx  Mx; reshape(x,n/2,2) ];y = [ my my+Dy; my+Dy  My; reshape(y,n/2,2) ];dx = [ 0  0; 0  0; reshape(dx,n/2,2) ];dy = [ 0  0; 0  0; reshape(dy,n/2,2) ];% PLOT THE ARROWS AND LABEL THE AXESquiver(x,y,dx,dy,fac,'w')xlabel('Longitude')ylabel('Latitude')hold offlandscape