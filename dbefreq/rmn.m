function smth = rmn(dat,len,rep)%  Function SMTH = RMN(dat,len,rep) -- Repeated running means%  Smooths a vector <rep> times with a moving average of length <len>.%  The length <len> must be an odd number.%%    EXAMPLE: If <dat> is monthly data, smth=rmn(dat,5,3) will return%    a triple five-month running mean version of the time series.%%  Uses MOVEAVG for each boxcar pass.%  MODS: Modified code so that it does repeated averaging as the docs suggest%        18-Jul-96, Trevor Cooper, tcooper@usd.edu.%  Written by D.B. Enfield%  NOAA/Atlantic Oceanographic & Meteorological Laboratory%  Miami, FL 33149 (305-361-4351); enfield@aoml.noaa.govif nargin < 3, rep = 1; endif floor(len/2)==len/2  error ('Length <len> must be an odd number.'); return;else  n=length(dat);  xdat=dat;     % added this line  for r=1:rep    xdat=moveavg(xdat,len);     % changed dat to xdat here  end  [nr1,nc1] = size(xdat);  [nr2,nc2] = size(dat);  if nr1==1    xx=nan*ones(nr2,(nc2-nc1)/2);    xy = [xx,xdat,xx];  elseif nc1==1    xx=nan*ones((nr2-nr1)/2,nc2);    xy = [xx',xdat',xx']';  end  smth = xy;end