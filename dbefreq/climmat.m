function climout = climmat(xx,tt)%Function climout = CLIMMAT(dat,tim) -- Climatology for matrix of time series.%%  The data matrix DAT must enter as <p> columns of <N> time values (rows). %  The time vector TIM of dimension N must contain the time values ex-%  pressed in fractional years, such as generated by TAXGEN. The climatology%  is computed for each column of DAT as the sum of the annual and next%  two harmonics (6 months and 4 months). For lengthy executions, a waitbar%  is displayed during execution; upon termination an alert is sounded, and %  the execution time is displayed.  %%  Calls HARM, WAITBAR, ALERT. [n,m]=size(tt);[nr,nc]=size(xx);           % Re-orient time if neededif n < m; tt=tt'; endif nr*nc > 1000; cue=1; else; cue=0; end   % Monitor statusif length(tt) ~= nr;                       % check matrix configuration	disp('Data inputs misconfigured...'); 	alert; 	return; endclimout = zeros(nr,nc);                    % Pre-allocate output matrixif cue == 1; h = waitbar(0,'Executing...'); endt0 = clock;for kk=1:nc	climout(:,kk) = harm(tt,xx(:,kk),1,3); % Compute summed harmonics	if cue == 1; waitbar(kk/nc); endendclose(h)alertif cue == 1 	disp(['Execution time = ' num2str(etime(clock,t0)/60) ' minutes']) end