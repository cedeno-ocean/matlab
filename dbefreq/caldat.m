function [year, month, day]=caldat(julian)%Function [year,month,day] = CALDAT(julian) - Julian day to calendar date%  Return the year, month, day corresponding to a given julian date.%  This is the inverse of the function JULDAY. The base date is the%  beginning of the Gregorian calendar (4713 BC). % Adapted from "Numerical Recipes in C",% by Press, Teukolsky, Vetterling, and Flannery.% Cambridge University Press, 1992 (2nd Edition).if nargin ~= 1  error('Usage: [year,month,day]=caldat(julian) (integer)');endigreg=2299161;                  % Beginning of Gregorian calendarja=julian;test=julian>=igreg;jalpha=fix((julian(test)-1867216-0.25)/36524.25);ja(test)=julian(test)+1+jalpha-fix(0.25*jalpha);jb=ja+1524;jc=fix(6680.0+((jb-2439870)-122.1)/365.25);jd=fix(365*jc+(0.25*jc));je=fix((jb-jd)/30.6001);day=jb-jd-fix(30.6001*je);month=je-1;test=month>12;month(test)=month(test)-12;year=jc-4715;test=month>2;year(test)=year(test)-1;test=year<=0;year(test)=year(test)-1;